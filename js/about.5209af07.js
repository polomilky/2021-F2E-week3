(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["about"],{3814:function(t,e,a){},e6e7:function(t,e,a){"use strict";a("3814")},f820:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-container",[a("div",{staticClass:"about"},[a("v-select",{attrs:{items:t.areaData,"item-text":"CityName","item-value":"City",label:"選擇縣市",dense:"",outlined:"","hide-details":"auto","return-object":""},on:{change:t.getSelectArea},model:{value:t.selectArea,callback:function(e){t.selectArea=e},expression:"selectArea"}}),a("hr"),a("v-text-field",{attrs:{label:"輸入公車路線",outlined:"",solo:"",dense:"","hide-details":"auto","append-icon":"mdi-magnify"},model:{value:t.routeName,callback:function(e){t.routeName=e},expression:"routeName"}}),a("v-btn",{on:{click:t.getSearchData}},[t._v("送出")]),a("div",t._l(t.aliveGoBusData,(function(e,n){return a("div",{key:n},[a("span",[t._v(t._s(e.stopName))]),0===e.stopStatus&&e.estimatedSeconds<120?a("span",[t._v("進站中"+t._s(e.estimatedSeconds)+"秒")]):t._e(),0===e.stopStatus&&e.estimatedSeconds>120?a("span",[t._v("約"+t._s(Math.floor(e.estimatedSeconds/60))+"分")]):t._e(),0!==e.stopStatus?a("span",[t._v(" "+t._s(1===e.stopStatus?"尚未發車":2===e.stopStatus?"交管不停靠":3===e.stopStatus?"末班車已過":"今日未營運")+" ")]):t._e()])})),0),a("hr")],1)])},o=[],s=a("3835"),i=a("1da1"),r=(a("96cf"),a("99af"),a("d3b7"),a("820e"),a("3ca3"),a("ddb0"),a("7db0"),a("4de4"),a("d81d"),a("c740"),a("6c2d")),c={name:"About",props:[],components:{},data:function(){return{selectArea:null,areaData:[],routeName:null,aliveGoBusData:[],aliveBackBusData:[]}},computed:{},methods:{getAuthorizationHeader:function(){var t="c73fee44c4c940f5a8d8bab640a4e5bd",e="Skml7ofY7at5RaJdUQ50e5A7J6g",a=(new Date).toGMTString(),n=new r["a"]("SHA-1","TEXT");n.setHMACKey(e,"TEXT"),n.update("x-date: "+a);var o=n.getHMAC("B64"),s='hmac username="'.concat(t,'",algorithm="hmac-sha1",headers="x-date",signature="').concat(o,'"');return{Authorization:s,"X-Date":a}},getAreaData:function(){var t=this;this.axios.get("https://gist.motc.gov.tw/gist_api/V3/Map/Basic/City?$format=JSON",{headers:this.getAuthorizationHeader()}).then((function(e){t.areaData=e.data})).catch((function(t){console.log(t)}))},getSelectArea:function(t){this.selectArea=t.City},getSearchData:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var a,n,o,i,r,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,Promise.allSettled([t.getEstimatedTimeData(),t.getStopOfRoute()]);case 3:o=e.sent,i=Object(s["a"])(o,2),r=i[0].value,c=i[1].value,console.log(r),console.log(c),t.aliveGoBusData=null!==(a=t.getStopsStatus(0,c,r))&&void 0!==a?a:[],t.aliveBackBusData=null!==(n=t.getStopsStatus(1,c,r))&&void 0!==n?n:[],e.next=16;break;case 13:e.prev=13,e.t0=e["catch"](0),alert("錯誤: ".concat(e.t0));case 16:case"end":return e.stop()}}),e,null,[[0,13]])})))()},getEstimatedTimeData:function(){var t=this;return new Promise((function(e,a){t.axios.get("https://ptx.transportdata.tw/MOTC/v2/Bus/EstimatedTimeOfArrival/City/".concat(t.selectArea,"/").concat(t.routeName,"?$format=JSON"),{headers:t.getAuthorizationHeader()}).then((function(t){e(t.data)})).catch((function(t){a(t)}))}))},getStopOfRoute:function(){var t=this;return new Promise((function(e,a){t.axios.get("https://ptx.transportdata.tw/MOTC/v2/Bus/StopOfRoute/City/".concat(t.selectArea,"/").concat(t.routeName,"?$format=JSON"),{headers:t.getAuthorizationHeader()}).then((function(t){e(t.data)})).catch((function(t){a(t)}))}))},getStopsStatus:function(t,e,a){var n;return null===(n=e.find((function(e){var a=e.Direction;return a===t})))||void 0===n?void 0:n.Stops.map((function(e){var n,o=null!==(n=a.find((function(a){var n=a.Direction,o=a.StopUID;return n===t&&o===e.StopUID})))&&void 0!==n?n:{},s=o.PlateNumb,i=o.EstimateTime,r=o.StopStatus;return{stopUID:e.StopUID,stopName:e.StopName.Zh_tw,stopStatus:r,plateNumb:s,estimatedSeconds:i}})).filter((function(t,e,a){return e===a.findIndex((function(e){return t.stopUID===e.stopUID}))}))}},mounted:function(){this.getAreaData()},watch:{}},u=c,l=(a("e6e7"),a("2877")),d=a("6544"),p=a.n(d),f=a("8336"),m=a("a523"),v=a("b974"),h=a("8654"),S=Object(l["a"])(u,n,o,!1,null,"7afd5816",null);e["default"]=S.exports;p()(S,{VBtn:f["a"],VContainer:m["a"],VSelect:v["a"],VTextField:h["a"]})}}]);
//# sourceMappingURL=about.5209af07.js.map